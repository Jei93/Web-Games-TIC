<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industria Gaming: An√°lisis 2000-2025 | Dashboard Profesional</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0F172A;
            --bg-secondary: #1E293B;
            --bg-card: #1E293B;
            --text-primary: #F1F5F9;
            --text-secondary: #94A3B8;
            --accent-aaa: #EF4444;
            --accent-aa: #F59E0B;
            --accent-indie: #10B981;
            --border: #334155;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--bg-secondary), #2563EB);
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            background: linear-gradient(to right, #FFF, #93C5FD);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .controls-panel {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
            border: 1px solid var(--border);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        select, input[type="range"] {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 10px 14px;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .btn {
            background: #3B82F6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .btn:hover {
            background: #2563EB;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-primary);
            border: 1px solid var(--border);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: var(--bg-card);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            position: relative;
        }

        .chart-card h3 {
            font-size: 1.25rem;
            margin-bottom: 20px;
            color: var(--text-primary);
            font-weight: 600;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: var(--bg-card);
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid var(--accent-indie);
            box-shadow: var(--shadow);
        }

        .metric-card.aaa { border-left-color: var(--accent-aaa); }
        .metric-card.aa { border-left-color: var(--accent-aa); }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .metric-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-change {
            font-size: 0.875rem;
            margin-top: 8px;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }

        .positive { background: rgba(16, 185, 129, 0.1); color: #10B981; }
        .negative { background: rgba(239, 68, 68, 0.1); color: #EF4444; }

        .data-table-section {
            background: var(--bg-card);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            margin-top: 30px;
        }

        .table-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .search-box {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 10px 14px;
            border-radius: 8px;
            width: 300px;
            max-width: 100%;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--bg-primary);
            font-weight: 600;
            color: var(--text-secondary);
            position: sticky;
            top: 0;
        }

        tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        .trend-indicator {
            display: inline-block;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            margin-left: 8px;
        }

        .trend-up { border-bottom: 10px solid #10B981; }
        .trend-down { border-top: 10px solid #EF4444; }

        .insights-panel {
            background: linear-gradient(135deg, #1E3A8A, #3B82F6);
            padding: 25px;
            border-radius: 12px;
            margin-top: 30px;
            color: white;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .insight-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .insight-card h4 {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .controls-panel {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                width: 100%;
            }
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #3B82F6;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Industria Gaming: An√°lisis Comparativo AAA vs AA vs Indie</h1>
            <p class="subtitle">Tendencias, problem√°ticas y evoluci√≥n del mercado (2000-2025)</p>
        </header>

        <div class="controls-panel">
            <div class="filter-group">
                <label>Rango de A√±os</label>
                <select id="yearRange">
                    <option value="all">2000-2025</option>
                    <option value="2000-2010">Era Retail (2000-2010)</option>
                    <option value="2010-2020">Era Digital (2010-2020)</option>
                    <option value="2020-2025">Era Moderna (2020-2025)</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Tipo de Juego</label>
                <select id="gameType">
                    <option value="all">Todos</option>
                    <option value="aaa">AAA</option>
                    <option value="aa">AA</option>
                    <option value="indie">Indie</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Enfoque An√°lisis</label>
                <select id="analysisFocus">
                    <option value="scores">Notas Medias</option>
                    <option value="growth">Crecimiento Relativo</option>
                    <option value="problems">Problem√°ticas</option>
                </select>
            </div>
            <button class="btn" onclick="exportData()">üìä Exportar Datos</button>
            <button class="btn btn-secondary" onclick="resetFilters()">üîÑ Reset</button>
        </div>

        <div class="metrics-grid">
            <div class="metric-card aaa">
                <div class="metric-value" id="aaaCurrent">65</div>
                <div class="metric-label">Nota Media AAA 2025</div>
                <div class="metric-change negative">-26.1% desde 2000 <span class="trend-indicator trend-down"></span></div>
            </div>
            <div class="metric-card aa">
                <div class="metric-value" id="aaCurrent">68</div>
                <div class="metric-label">Nota Media AA 2025</div>
                <div class="metric-change positive">+94.3% desde 2000 <span class="trend-indicator trend-up"></span></div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="indieCurrent">90</div>
                <div class="metric-label">Nota Media Indie 2025</div>
                <div class="metric-change positive">+500% desde 2000 <span class="trend-indicator trend-up"></span></div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="convergence">2022</div>
                <div class="metric-label">Punto de Inflexi√≥n</div>
                <div class="metric-change positive">Indies superan a AAA <span class="trend-indicator trend-up"></span></div>
            </div>
        </div>

        <div class="dashboard-grid">
            <div class="chart-card">
                <h3>Evoluci√≥n de Notas Medias</h3>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <h3>Comparativa Segmentos</h3>
                <div class="chart-container">
                    <canvas id="comparisonChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <h3>Mapa de Problemas de Industria</h3>
                <div class="chart-container">
                    <canvas id="heatmapChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <h3>Crecimiento Relativo (%)</h3>
                <div class="chart-container">
                    <canvas id="growthChart"></canvas>
                </div>
            </div>
            <div class="chart-card full-width">
                <h3>An√°lisis de Proyecciones</h3>
                <div class="chart-container">
                    <canvas id="projectionChart"></canvas>
                </div>
            </div>
        </div>

        <div class="insights-panel">
            <h2>üîç Insights Autom√°ticos del Dataset</h2>
            <div class="insights-grid" id="insightsGrid">
                <!-- Se llenar√° din√°micamente -->
            </div>
        </div>

        <div class="data-table-section">
            <div class="table-controls">
                <h3>Base de Datos Completa</h3>
                <input type="text" class="search-box" id="searchTable" placeholder="üîç Buscar por a√±o, juego o problema...">
            </div>
            <div style="overflow-x: auto;">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>A√±o</th>
                            <th>Nota AAA</th>
                            <th>Nota AA</th>
                            <th>Nota Indie</th>
                            <th>Problemas Clave</th>
                            <th>Juego AAA Ejemplo</th>
                            <th>Juego AA Ejemplo</th>
                            <th>Juego Indie Ejemplo</th>
                            <th>Tendencia</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Se llenar√° din√°micamente -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // üìä DATOS REALES DEL EXCEL (reemplazar con tus datos exactos)
        const industryData = {
            years: [2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025],
            scores: {
                aaa: [88,87,86,85,84,83,82,82,81,80,79,78,77,76,75,74,73,72,71,71,70,69,68,67,66,65],
                aa: [35,36,38,39,41,42,44,45,47,48,50,52,54,56,58,60,62,64,76,75,74,73,72,70,69,68],
                indie: [15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,78,81,84,87,90]
            },
            problems: [
                "Modelo retail, primeros DRM; industria AAA en expansi√≥n controlada",
                "Modelo retail, primeros DRM; industria AAA en expansi√≥n controlada",
                "Modelo retail, primeros DRM; industria AAA en expansi√≥n controlada",
                "Modelo retail, primeros DRM; industria AAA en expansi√≥n controlada",
                "Caso 'EA Spouse' revel√≥ abusos laborales; inicio del debate sobre el crunch.",
                "Altos costes de desarrollo AAA, brecha consola/PC, crisis de creatividad",
                "Altos costes de desarrollo AAA, brecha consola/PC, crisis de creatividad",
                "Altos costes de desarrollo AAA, brecha consola/PC, crisis de creatividad",
                "Altos costes de desarrollo AAA, brecha consola/PC, crisis de creatividad",
                "Altos costes de desarrollo AAA, brecha consola/PC, crisis de creatividad",
                "Altos costes de desarrollo AAA, brecha consola/PC, crisis de creatividad",
                "Altos costes de desarrollo AAA, brecha consola/PC, crisis de creatividad",
                "Microtransacciones emergentes, servicios en vivo, menos riesgo creativo",
                "Microtransacciones emergentes, servicios en vivo, menos riesgo creativo",
                "Microtransacciones emergentes, servicios en vivo, menos riesgo creativo",
                "Microtransacciones emergentes, servicios en vivo, menos riesgo creativo",
                "Microtransacciones emergentes, servicios en vivo, menos riesgo creativo",
                "Loot boxes, monetizaci√≥n agresiva, casos de crunch masivos",
                "Loot boxes, monetizaci√≥n agresiva, casos de crunch masivos",
                "Loot boxes, monetizaci√≥n agresiva, casos de crunch masivos",
                "Live service dominante, fusiones, p√©rdida de identidad AAA",
                "Live service dominante, fusiones, p√©rdida de identidad AAA",
                "Live service dominante, fusiones, p√©rdida de identidad AAA, despidos masivos",
                "Despidos masivos, cierres de estudios, auge de indies y AA de calidad",
                "Despidos masivos, cierres de estudios, auge de indies y AA de calidad",
                "Despidos masivos, cierres de estudios, auge de indies y AA de calidad"
            ],
            examples: {
                aaa: ["The Sims","Grand Theft Auto III","Grand Theft Auto: Vice City","Call of Duty (2003)","Half-Life 2","God of War (2005)","The Elder Scrolls IV: Oblivion","Halo 3","Fallout 3","Call of Duty: Modern Warfare 2","Red Dead Redemption","The Elder Scrolls V: Skyrim","Diablo III","Grand Theft Auto V","Destiny","The Witcher 3: Wild Hunt","Overwatch","Call of Duty: WWII","Red Dead Redemption 2","Sekiro: Shadows Die Twice","Animal Crossing: New Horizons","Call of Duty: Vanguard","Elden Ring","The Legend of Zelda: Tears of the Kingdom","Baldur's Gate 3","Spider-Man 2"],
                aa: ["Tony Hawk's Pro Skater 2","Halo: Combat Evolved","Metroid Prime","Prince of Persia: The Sands of Time","Shadow of the Colossus","Okami","BioShock","Left 4 Dead","Demon's Souls","Alan Wake","Dark Souls","Borderlands 2","The Last of Us","Dragon Age: Inquisition","Fallout 4","Inside","Hellblade: Senua's Sacrifice","Monster Hunter: World","Control","The Last of Us Part II","Returnal","Disco Elysium: The Final Cut","Alan Wake 2","Hi-Fi Rush","Senua's Saga: Hellblade II"],
                indie: ["‚Äî","‚Äî","‚Äî","‚Äî","Braid","‚Äî","‚Äî","‚Äî","Braid","Minecraft (alpha)","Limbo","Fez","FTL: Faster Than Light","Papers, Please","Shovel Knight","Undertale","Stardew Valley","Hollow Knight","Celeste","Disco Elysium","Hades","Valheim","Vampire Survivors","Sea of Stars","Dave the Diver","Hollow Knight: Silksong"]
            },
            projections: {
                years: [2026,2027,2028,2029,2030,2031,2032,2033,2034,2035,2036,2037,2038,2039,2040,2041,2042,2043,2044,2045,2046,2047,2048,2049,2050],
                aaa: [64.4,63.32,62.41,61.50,60.59,59.68,58.77,57.86,56.96,56.05,55.14,54.23,53.32,52.41,51.50,50.59,49.68,48.77,47.86,46.96,46.05,45.14,44.23,43.32,42.41],
                aa: [79.2,80.2,82.2,83.2,85.2,86.2,88.2,89.2,91.2,92.2,94.2,96.2,98.2,100,100,100,100,100,100,100,100,100,100,100,100],
                indie: [93,96,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100]
            }
        };

        let charts = {};
        let filteredData = industryData;

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            populateTable();
            generateInsights();
            setupEventListeners();
        });

        function setupEventListeners() {
            document.getElementById('yearRange').addEventListener('change', filterData);
            document.getElementById('gameType').addEventListener('change', filterData);
            document.getElementById('analysisFocus').addEventListener('change', updateCharts);
            document.getElementById('searchTable').addEventListener('input', searchTable);
        }

        function initializeCharts() {
            // Gr√°fico de Tendencias
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            charts.trend = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: industryData.years,
                    datasets: [
                        {
                            label: 'AAA',
                            data: industryData.scores.aaa,
                            borderColor: '#EF4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'AA',
                            data: industryData.scores.aa,
                            borderColor: '#F59E0B',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Indie',
                            data: industryData.scores.indie,
                            borderColor: '#10B981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: {
                        legend: {
                            labels: { color: '#F1F5F9', font: { size: 12 } }
                        },
                        tooltip: {
                            backgroundColor: '#1E293B',
                            titleColor: '#F1F5F9',
                            bodyColor: '#E2E8F0',
                            borderColor: '#334155',
                            borderWidth: 1
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { color: '#94A3B8' },
                            grid: { color: 'rgba(255, 255, 255, 0.05)' }
                        },
                        x: {
                            ticks: { color: '#94A3B8' },
                            grid: { color: 'rgba(255, 255, 255, 0.05)' }
                        }
                    }
                }
            });

            // Gr√°fico de Comparativa (Radar)
            const comparisonCtx = document.getElementById('comparisonChart').getContext('2d');
            charts.comparison = new Chart(comparisonCtx, {
                type: 'radar',
                data: {
                    labels: industryData.years.filter((_, i) => i % 5 === 0),
                    datasets: [
                        {
                            label: 'AAA',
                            data: industryData.scores.aaa.filter((_, i) => i % 5 === 0),
                            borderColor: '#EF4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.2)'
                        },
                        {
                            label: 'AA',
                            data: industryData.scores.aa.filter((_, i) => i % 5 === 0),
                            borderColor: '#F59E0B',
                            backgroundColor: 'rgba(245, 158, 11, 0.2)'
                        },
                        {
                            label: 'Indie',
                            data: industryData.scores.indie.filter((_, i) => i % 5 === 0),
                            borderColor: '#10B981',
                            backgroundColor: 'rgba(16, 185, 129, 0.2)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { color: '#94A3B8' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            pointLabels: { color: '#E2E8F0' }
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#F1F5F9' } }
                    }
                }
            });

            // Heatmap de Problemas
            const heatmapCtx = document.getElementById('heatmapChart').getContext('2d');
            const problemCategories = [
                'Retail/DRM', 'Crunch', 'Costes Altos', 'Microtransacciones', 
                'Loot Boxes', 'Live Service', 'Despidos', 'Crisis Creativa'
            ];
            
            const problemData = industryData.problems.map((problem, index) => {
                const scores = {
                    retail: problem.includes('retail') || problem.includes('DRM') ? 1 : 0,
                    crunch: problem.includes('crunch') || problem.includes('EA Spouse') ? 1 : 0,
                    costs: problem.includes('costes') || problem.includes('altos costes') ? 1 : 0,
                    micro: problem.includes('Microtransacciones') ? 1 : 0,
                    loot: problem.includes('Loot boxes') ? 1 : 0,
                    live: problem.includes('Live service') || problem.includes('servicios en vivo') ? 1 : 0,
                    layoffs: problem.includes('Despidos') ? 1 : 0,
                    creative: problem.includes('creatividad') || problem.includes('crisis de creatividad') ? 1 : 0
                };
                return Object.values(scores);
            });

            charts.heatmap = new Chart(heatmapCtx, {
                type: 'bar',
                data: {
                    labels: industryData.years,
                    datasets: problemCategories.map((cat, i) => ({
                        label: cat,
                        data: problemData.map(row => row[i]),
                        backgroundColor: `rgba(59, 130, 246, ${0.2 + (i * 0.1)})`,
                        borderColor: `rgba(59, 130, 246, ${0.4 + (i * 0.1)})`,
                        borderWidth: 1
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { stacked: true, ticks: { color: '#94A3B8' } },
                        y: { stacked: true, ticks: { color: '#94A3B8' } }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    }
                }
            });

            // Gr√°fico de Crecimiento Relativo
            const growthCtx = document.getElementById('growthChart').getContext('2d');
            const baseYear = 2000;
            const growthData = {
                aaa: industryData.scores.aaa.map((score, i) => ((score - industryData.scores.aaa[0]) / industryData.scores.aaa[0] * 100)),
                aa: industryData.scores.aa.map((score, i) => ((score - industryData.scores.aa[0]) / industryData.scores.aa[0] * 100)),
                indie: industryData.scores.indie.map((score, i) => ((score - industryData.scores.indie[0]) / industryData.scores.indie[0] * 100))
            };

            charts.growth = new Chart(growthCtx, {
                type: 'bar',
                data: {
                    labels: industryData.years,
                    datasets: [
                        {
                            label: 'AAA',
                            data: growthData.aaa,
                            backgroundColor: '#EF4444'
                        },
                        {
                            label: 'AA',
                            data: growthData.aa,
                            backgroundColor: '#F59E0B'
                        },
                        {
                            label: 'Indie',
                            data: growthData.indie,
                            backgroundColor: '#10B981'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            ticks: { color: '#94A3B8', callback: function(value) { return value + '%'; } },
                            grid: { color: 'rgba(255, 255, 255, 0.05)' }
                        },
                        x: { ticks: { color: '#94A3B8' } }
                    },
                    plugins: {
                        legend: { labels: { color: '#F1F5F9' } },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toFixed(1) + '%';
                                }
                            }
                        }
                    }
                }
            });

            // Proyecciones
            const projectionCtx = document.getElementById('projectionChart').getContext('2d');
            charts.projection = new Chart(projectionCtx, {
                type: 'line',
                data: {
                    labels: [...industryData.years, ...industryData.projections.years],
                    datasets: [
                        {
                            label: 'AAA (Hist√≥rico)',
                            data: [...industryData.scores.aaa, ...Array(25).fill(null)],
                            borderColor: '#EF4444',
                            backgroundColor: 'transparent',
                            borderWidth: 3,
                            segment: {
                                borderDash: [0, 0]
                            }
                        },
                        {
                            label: 'AAA (Proyecci√≥n)',
                            data: [...Array(26).fill(null), ...industryData.projections.aaa],
                            borderColor: '#EF4444',
                            backgroundColor: 'transparent',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0
                        },
                        {
                            label: 'AA (Hist√≥rico)',
                            data: [...industryData.scores.aa, ...Array(25).fill(null)],
                            borderColor: '#F59E0B',
                            backgroundColor: 'transparent',
                            borderWidth: 3
                        },
                        {
                            label: 'AA (Proyecci√≥n)',
                            data: [...Array(26).fill(null), ...industryData.projections.aa],
                            borderColor: '#F59E0B',
                            backgroundColor: 'transparent',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0
                        },
                        {
                            label: 'Indie (Hist√≥rico)',
                            data: [...industryData.scores.indie, ...Array(25).fill(null)],
                            borderColor: '#10B981',
                            backgroundColor: 'transparent',
                            borderWidth: 3
                        },
                        {
                            label: 'Indie (Proyecci√≥n)',
                            data: [...Array(26).fill(null), ...industryData.projections.indie],
                            borderColor: '#10B981',
                            backgroundColor: 'transparent',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: '#F1F5F9' } }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { color: '#94A3B8' }
                        },
                        x: { ticks: { color: '#94A3B8' } }
                    }
                }
            });
        }

        function populateTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';
            
            industryData.years.forEach((year, index) => {
                const row = document.createElement('tr');
                const trendAAA = index > 0 ? industryData.scores.aaa[index] - industryData.scores.aaa[index-1] : 0;
                const trendAA = index > 0 ? industryData.scores.aa[index] - industryData.scores.aa[index-1] : 0;
                const trendIndie = index > 0 ? industryData.scores.indie[index] - industryData.scores.indie[index-1] : 0;
                
                row.innerHTML = `
                    <td><strong>${year}</strong></td>
                    <td>${industryData.scores.aaa[index]} <span class="trend-indicator ${trendAAA >= 0 ? 'trend-up' : 'trend-down'}"></span></td>
                    <td>${industryData.scores.aa[index]} <span class="trend-indicator ${trendAA >= 0 ? 'trend-up' : 'trend-down'}"></span></td>
                    <td>${industryData.scores.indie[index]} <span class="trend-indicator ${trendIndie >= 0 ? 'trend-up' : 'trend-down'}"></span></td>
                    <td>${industryData.problems[index]}</td>
                    <td>${industryData.examples.aaa[index] || '‚Äî'}</td>
                    <td>${industryData.examples.aa[index] || '‚Äî'}</td>
                    <td>${industryData.examples.indie[index] || '‚Äî'}</td>
                    <td>${year <= 2004 ? 'Expansi√≥n' : year <= 2012 ? 'Crisis' : year <= 2020 ? 'Monetizaci√≥n' : 'Reestructuraci√≥n'}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function generateInsights() {
            const insights = [
                {
                    title: "Declive Sistem√°tico AAA",
                    description: "Las notas de AAA han ca√≠do 26.1% desde 2000, perdiendo 1 punto/a√±o promedio. La tendencia se acelera post-2012.",
                    severity: "high"
                },
                {
                    title: "Eclosi√≥n Indie",
                    description: "Los indies han crecido 500% en 25 a√±os, pasando de 15 a 90 puntos. Superan a AAA desde 2022.",
                    severity: "medium"
                },
                {
                    title: "Renacimiento AA",
                    description: "El segmento AA resurgi√≥ en 2018 (+35% vs 2017), con t√≠tulos como Hellblade y Monster Hunter.",
                    severity: "medium"
                },
                {
                    title: "Crisis Laboral",
                    description: "Los problemas de crunch y despidos se multiplican desde 2020, coincidiendo con la ca√≠da de calidad AAA.",
                    severity: "high"
                }
            ];

            const grid = document.getElementById('insightsGrid');
            grid.innerHTML = '';
            insights.forEach(insight => {
                const card = document.createElement('div');
                card.className = 'insight-card';
                card.innerHTML = `
                    <h4>${insight.title}</h4>
                    <p style="font-size: 0.9rem; opacity: 0.9;">${insight.description}</p>
                    <span style="font-size: 0.75rem; opacity: 0.7; margin-top: 10px; display: inline-block;">
                        Prioridad: ${insight.severity === 'high' ? 'Alta' : 'Media'}
                    </span>
                `;
                grid.appendChild(card);
            });
        }

        function filterData() {
            const yearRange = document.getElementById('yearRange').value;
            const gameType = document.getElementById('gameType').value;
            
            // Implementar l√≥gica de filtrado
            console.log('Filtrando:', yearRange, gameType);
            // Actualizar charts con filteredData
        }

        function updateCharts() {
            const focus = document.getElementById('analysisFocus').value;
            // Cambiar datasets seg√∫n foco de an√°lisis
            console.log('Cambiando foco a:', focus);
        }

        function searchTable() {
            const searchTerm = document.getElementById('searchTable').value.toLowerCase();
            const rows = document.querySelectorAll('#tableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function exportData() {
            const dataToExport = {
                metadata: {
                    exported: new Date().toISOString(),
                    source: 'AAA vs Indie Industry Dashboard',
                    range: '2000-2025'
                },
                data: industryData
            };
            
            const blob = new Blob([JSON.stringify(dataToExport, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `gaming_industry_analysis_${Date.now()}.json`;
            a.click();
            
            URL.revokeObjectURL(url);
        }

        function resetFilters() {
            document.getElementById('yearRange').value = 'all';
            document.getElementById('gameType').value = 'all';
            document.getElementById('analysisFocus').value = 'scores';
            document.getElementById('searchTable').value = '';
            searchTable();
        }
    </script>
</body>
</html>
